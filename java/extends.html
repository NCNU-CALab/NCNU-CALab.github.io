<!DOCTYPE html>
<html lang="zh">
  <head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">

    <title>SSYU 的書們 | 繼承 </title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <!-- fonts -->
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,600,700" rel="stylesheet">

    <!-- stylesheets -->
    <link rel="stylesheet" href="/style/doc.css">

    <!-- favicon -->
    <link rel="icon" href="/images/favicon.ico"><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    

  </head>
  <body>

   <!-- hexo-inject:begin --><!-- hexo-inject:end --><script>window.__INITIAL_STATE__ = {"page":{"title":"繼承","path":"java/extends.html"},"data":{"navigation":{"logo":{"text":"Programming Yu","type":"link","path":"index.html"},"main":[{"text":"C 程式語言教學","type":"label","children":[{"text":"程式寫作概論","type":"link","path":"c/writing-intro.html"},{"text":"電腦系統概論","type":"link","path":"c/system-intro.html"},{"text":"電腦內部運作","type":"link","path":"c/system-operation.html"},{"text":"C 語言的總覽","type":"link","path":"c/c-intro.html"}]},{"text":"C 程式語言範例","type":"label","children":[{}]},{"text":"Java 程式語言教學","type":"label","children":[{"text":"Java 與 C 的比較","type":"link","path":"java/java-vs-c.html"},{"text":"類別與物件","type":"link","path":"java/class-and-obj.html"},{"text":"陣列","type":"link","path":"java/array.html"},{"text":"封裝","type":"link","path":"java/encapsulation.html"},{"text":"訊息傳遞","type":"link","path":"java/message-passing.html"},{"text":"繼承","type":"link","path":"java/extends.html"},{"text":"介面","type":"link","path":"java/interface.html"},{"text":"例外處理","type":"link","path":"java/exception.html"},{"text":"線串與同步處理","type":"link","path":"java/thread.html"},{"text":"容器類別","type":"link","path":"java/container.html"},{"text":"GUI","type":"link","path":"java/gui.html"},{"text":"IO","type":"link","path":"java/io.html"},{"text":"NET","type":"link","path":"java/net.html"},{"text":"JDBC","type":"link","path":"java/jdbc.html"},{"text":"印表","type":"link","path":"java/easy-print.html"}]},{"text":"Java 程式語言範例","type":"label","children":[{"text":"所得稅計算","type":"link","path":"java/examples/tax-calculate.html"}]},{"text":"資料結構與演算法","type":"label"}]},"posts":[{"text":"The 3n + 1 problem","type":"link","path":"questions/The-3n-1-problem/","date":"2017-12-21T19:53:25+00:00"}]},"config":{"timezone":"Asia/Taipei","root":"/","time_format":"HH:mm:ss","theme":"doc","theme_config":{"swagger_ui":{"version":2,"permalinks":true,"api_explorer":true,"download":"Download specification","show_extensions":false,"deep_linking":true,"display_operation_id":false,"doc_expansion":"none"},"search":{"skip":false,"background":false,"route":"/lunr.json"},"favicon":"images/favicon.ico"}}}</script>

    <div id="react-navigation-root"><div class="doc-navigation" data-reactroot=""><nav class="doc-navbar"><a href="/index.html" class="doc-navbar__logo"><img src="/images/logo.png" class="doc-navbar__logo__img"/><span class="doc-navbar__logo__text">Programming Yu</span></a><i class="dc-icon dc-icon--close dc-icon--interactive doc-sidebar-close doc-navbar__sidebar-close doc-navbar__sidebar-close--desktop"></i><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-navbar__sidebar-toggle"></i></nav><nav class="doc-sidebar"><div class="doc-sidebar__vertical-menu"><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-sidebar-toggle--primary doc-sidebar__vertical-menu__item"></i><i class="dc-icon dc-icon--search dc-icon--interactive doc-sidebar__vertical-menu__item doc-sidebar__vertical-menu__item--primary"></i></div><div class="doc-sidebar-content"><div class="doc-sidebar__search-form"></div><ul class="doc-sidebar-list"></ul></div></nav></div></div>
    <div class="doc-content">
  <div class="dc-page">
    <div class="dc-card">
      <div id="react-search-results-root"></div>
      <div id="page-content" class="doc-formatting">
        <h1>繼承</h1>
        <h2 id="基本觀念"><a href="#基本觀念" class="headerlink" title="基本觀念"></a>基本觀念</h2><p>Encapsulation, Message Passing 以及 Inheritance 是構成 Object-Oriented 的三大要素，如果某程式語言只具備前面兩項特性，一般成為 Object-Based。所謂 Inheritance(繼承)，是指 Sub Class(子類別) 繼承 Super Class(父類別) 後，就會自動取得父類別特性。如果子類別繼承了一個以上的父類別，則稱為 Multiple Inheritance(多重繼承)。Java 為了避開多重繼承的複雜性，class 只允許單一繼承。</p>
<p>Java 使用關鍵字 <code>extends</code> 來表達繼承觀念：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Unspecified"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Fly"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"run"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fish</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"swim"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>若 class 宣告時沒有指定 <code>extends</code>, 則 Java 會自動 <code>extends java.lang.Object</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>和下面的寫法相同</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Object</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="UpCasting-向上轉型-和-DownCasting-向下轉型"><a href="#UpCasting-向上轉型-和-DownCasting-向下轉型" class="headerlink" title="UpCasting(向上轉型) 和 DownCasting(向下轉型)"></a>UpCasting(向上轉型) 和 DownCasting(向下轉型)</h2><p>所謂 casting 是指型態轉換，UpCasting 是將子類別型態的 reference 轉型為父類別型態，DownCasting 則是將父類別型態的 reference 轉型成子類別型態。由於子類別可以視為和父類別相容，如 <code>Fish</code>, <code>Dog</code>, <code>Bird</code> 都是一種 <code>Animal</code>，因此 UpCasting 一定沒有問題：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Animal a;</span><br><span class="line">Bird b;</span><br><span class="line">a = b; <span class="comment">// upcasting, Bird is a kind of Animal</span></span><br></pre></td></tr></table></figure>
<p>父類別的 reference 可以指到子類別的 Object，這種觀念稱為 <strong>Polymorphism(多型)</strong>。</p>
<p>但在 downcasting 的情況下，父類別的 reference 和子類別並不相容，如 <code>Animal</code> 不見得是一個 <code>Bird</code>，因此必須使用 (SubClass) 的 casting 語法來做強迫轉換。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Animal a = <span class="keyword">new</span> Bird(); <span class="comment">// upcasting</span></span><br><span class="line">Bird b;</span><br><span class="line">b = (Bird)a; <span class="comment">// downcasting, compile correct</span></span><br><span class="line"><span class="keyword">if</span> (a <span class="keyword">instanceof</span> Bird) &#123; <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>downcasting 除了必須由設計者下達外, JVM 在 runtime 也會檢查實際的物件能否和 reference 的型態相容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Animal a = <span class="keyword">new</span> Dog(); <span class="comment">// upcasting</span></span><br><span class="line">Bird b;</span><br><span class="line">b = (Bird) a; <span class="comment">// downcasting, compile correct, but runtime error</span></span><br></pre></td></tr></table></figure>
<p>比較完整的範例如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InheritanceExample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span> </span>&#123;</span><br><span class="line">        Animal a1, a2, a3, a4;</span><br><span class="line">        Bird b;</span><br><span class="line">        Dog d;</span><br><span class="line">        Fish f;</span><br><span class="line">        a2 = a1 = <span class="keyword">new</span> Animal();</span><br><span class="line">        b = <span class="keyword">new</span> Bird();</span><br><span class="line">        d = <span class="keyword">new</span> Dog();</span><br><span class="line">        f = <span class="keyword">new</span> Fish();</span><br><span class="line">        System.out.println(a1.moveMethod());</span><br><span class="line">        System.out.println(b.moveMethod());</span><br><span class="line">        System.out.println(d.moveMethod());</span><br><span class="line">        System.out.println(f.moveMethod());</span><br><span class="line">        a1 = b; <span class="comment">// Correct, we call this upcasting</span></span><br><span class="line">        b = a1; <span class="comment">// Compile Error, type not compatible</span></span><br><span class="line">        b = (Bird)a1; <span class="comment">// downcasting, Compile Correct</span></span><br><span class="line">        a2 = b; <span class="comment">// Correct,we call this upcasting</span></span><br><span class="line">        d = a2; <span class="comment">// Compile Error, type not compatible</span></span><br><span class="line">        d = (Dog)a2; <span class="comment">// Compile Correct, but runtime error</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Override-覆寫"><a href="#Override-覆寫" class="headerlink" title="Override(覆寫)"></a>Override(覆寫)</h2><p>子類別重新定義它所能看到的父類別中的 method(如 <code>public</code>, <code>protected</code>，如果子類別和父類別在同一個 <code>package</code> 裡，則沒有修飾字的 method 也可以)，稱為 override。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Unspecified"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="comment">// override Animal's moveMethod</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Fly"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>要特別強調的是</p>
<ul>
<li>如果子類別看不到父類別的方法 (如父類別的 <code>private</code> 方法，或子父類別不在同一個 <code>package</code> 而子類別定義了父類別內的 package method)，則就算定義了同樣的 method，也不是 override</li>
<li>重複定義 static method 也不算 override</li>
<li>子類別不可縮小父類別方法的存取範圍</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">C1</span> <span class="keyword">extends</span> <span class="title">C2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">()</span> </span>&#123; <span class="comment">// Compile Error,不得縮小存取範圍</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Virtual-Function-虛擬函數"><a href="#Virtual-Function-虛擬函數" class="headerlink" title="Virtual Function(虛擬函數)"></a>Virtual Function(虛擬函數)</h2><p>在訊息傳遞的章節裡，我們有提到過 Object 接收到訊息後，是在 Runtime 才決定實際所要呼叫的 Method。由於父類別的 reference 可以指到子類別物件 (Polymorphism)，而子類別和父類別可能都定義了相同的 Method(Override)，當使用父類別 reference 傳遞訊息給子類別物件時，應該要呼叫父類別的方法還是子類別的方法？如果</p>
<ul>
<li>呼叫子類別的方法, 則稱為 Virtual Function</li>
<li>呼叫父類別的方法, 則稱為 Non-Virtual Function</li>
</ul>
<p>有些程式語言，如 C++，以上兩種機制都提供，可由設計者自行決定。但是 Java 語言為了遵循物件導向的精神，並避免設計者因語言設計複雜而犯錯，因此只提供了 Virtual Function。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InheritanceExample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span> </span>&#123;</span><br><span class="line">        Animal a1;</span><br><span class="line">        a1 = <span class="keyword">new</span> Animal();</span><br><span class="line">        System.out.println(a1.moveMethod()); <span class="comment">// print out "Unspecified"</span></span><br><span class="line">        a1 = <span class="keyword">new</span> Bird(); <span class="comment">// polymorphism</span></span><br><span class="line">        System.out.println(a1.moveMethod()); <span class="comment">// print out "Fly"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>請注意上一小節所提到 Override 的注意事項</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Unspecified"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span> </span>&#123;</span><br><span class="line">        Animal a1;</span><br><span class="line">        a1 = <span class="keyword">new</span> Bird();</span><br><span class="line">        System.out.println(a1.moveMethod()); <span class="comment">// print out "Unspecified"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="comment">// we can't override static method</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Fly"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的 <code>moveMethod()</code> 由於宣告為 <code>static</code>，因此是依照 reference 的 type 來決定執行的 method。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Unspecified"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span> </span>&#123;</span><br><span class="line">        Animal a1;</span><br><span class="line">        a1 = <span class="keyword">new</span> Bird();</span><br><span class="line">        System.out.println(a1.moveMethod()); <span class="comment">// print out "Unspecified"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="comment">// this is not override because Bird can't see Animal's moveMethod</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">moveMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Fly"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由於上面 <code>Animal</code> 內的 <code>moveMethod</code> 宣告為 <code>private</code>，因此執行時印出 <code>&quot;Unspecified&quot;</code>。</p>
<p>採用 Virtual Function 的優點</p>
<ul>
<li>Runtime 自動尋找最特定的方法 (儘量用子類別的方法)，可用父類別 reference 呼叫到子類別的方法，因此增加新的子類別時，不需要修改程式</li>
</ul>
<p>缺點</p>
<ul>
<li>執行起來比較慢</li>
</ul>
<h2 id="本章觀念整理範例"><a href="#本章觀念整理範例" class="headerlink" title="本章觀念整理範例"></a>本章觀念整理範例</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Shape2D</span> </span>&#123; <span class="comment">// define super class</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">area</span><span class="params">()</span> </span>&#123; <span class="comment">// all Shape2D have their own area</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">extends</span> <span class="title">Shape2D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> length, width;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> w)</span> </span>&#123; <span class="comment">// define constructor</span></span><br><span class="line">        length = l;</span><br><span class="line">        width = w;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">area</span><span class="params">()</span> </span>&#123; <span class="comment">// Override</span></span><br><span class="line">        <span class="keyword">return</span> length * width;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">extends</span> <span class="title">Shape2D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> radius;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Circle</span><span class="params">(<span class="keyword">double</span> r)</span> </span>&#123;</span><br><span class="line">        radius = r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">area</span><span class="params">()</span> </span>&#123; <span class="comment">// Override</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">3.141592654</span> * radius * radius;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Parallelogram</span> <span class="keyword">extends</span> <span class="title">Shape2D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> top, bottom, height;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Parallelogram</span><span class="params">(<span class="keyword">double</span> t, <span class="keyword">double</span> b, <span class="keyword">double</span> h)</span> </span>&#123;</span><br><span class="line">        top = t;</span><br><span class="line">        bottom = b;</span><br><span class="line">        height = h;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">area</span><span class="params">()</span> </span>&#123; <span class="comment">// Override</span></span><br><span class="line">        <span class="keyword">return</span> (top + bottom) * height / <span class="number">2.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">publicclass Main &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">sum</span><span class="params">(Shape2D[] shapes)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> total = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; shapes.length; i++) &#123;</span><br><span class="line">            total += shapes[i].area(); <span class="comment">// use Virtual Function to calculate area of Shape2D</span></span><br><span class="line">                                       <span class="comment">// Without Virtual Function, value of Shape2D.area() will be 0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span> </span>&#123;</span><br><span class="line">        Shape2D[] data; <span class="comment">// array of reference to Shape2D</span></span><br><span class="line">        data = <span class="keyword">new</span> Shape2D[<span class="number">5</span>]; <span class="comment">// create array object</span></span><br><span class="line">        data[<span class="number">0</span>] = <span class="keyword">new</span> Rectangle(<span class="number">2.4</span>, <span class="number">3.8</span>); <span class="comment">// Polymorphism</span></span><br><span class="line">        data[<span class="number">1</span>] = <span class="keyword">new</span> Circle(<span class="number">3.9</span>);</span><br><span class="line">        data[<span class="number">2</span>] = <span class="keyword">new</span> Parallelogram(<span class="number">3.5</span>, <span class="number">6.7</span>, <span class="number">10.2</span>);</span><br><span class="line">        data[<span class="number">3</span>] = <span class="keyword">new</span> Rectangle(<span class="number">5.3</span>, <span class="number">7.2</span>);</span><br><span class="line">        data[<span class="number">4</span>] = <span class="keyword">new</span> Circle(<span class="number">4.6</span>);</span><br><span class="line">        System.out.println(<span class="string">"Sum of all Shape2D is "</span>+sum(data));</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果程式語言不支援 virtual function 的話，則上面的範例就得寫成下面的形式才行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123; <span class="comment">// example for non-virtual function implementation</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">sum</span><span class="params">(Shape2D[] shapes)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> total = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;  i &lt; shapes.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (shapes[i] <span class="keyword">instanceof</span> Rectangle) &#123;</span><br><span class="line">                total += ((Rectangle)shapes[i]).area();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (shapes[i] <span class="keyword">instanceof</span> Circle) &#123;</span><br><span class="line">                total += ((Circle)shapes[i]).area();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (shapes[i] <span class="keyword">instanceof</span> Parallelogram) &#123;</span><br><span class="line">                total += ((Parallelogram)shapes[i]).area();</span><br><span class="line">            &#125; <span class="comment">// modify source code here for new sub classes</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span> </span>&#123;</span><br><span class="line">        Shape2D[] data; <span class="comment">// array of reference to Shape2D</span></span><br><span class="line">        data = <span class="keyword">new</span> Shape2D[<span class="number">5</span>]; <span class="comment">// create array object</span></span><br><span class="line">        data[<span class="number">0</span>] = <span class="keyword">new</span> Rectangle(<span class="number">2.4</span>, <span class="number">3.8</span>); <span class="comment">// Polymorphism</span></span><br><span class="line">        data[<span class="number">1</span>] = <span class="keyword">new</span> Circle(<span class="number">3.9</span>);</span><br><span class="line">        data[<span class="number">2</span>] = <span class="keyword">new</span> Parallelogram(<span class="number">3.5</span>, <span class="number">6.7</span>, <span class="number">10.2</span>);</span><br><span class="line">        data[<span class="number">3</span>] = <span class="keyword">new</span> Rectangle(<span class="number">5.3</span>, <span class="number">7.2</span>);</span><br><span class="line">        data[<span class="number">4</span>] = <span class="keyword">new</span> Circle(<span class="number">4.6</span>);</span><br><span class="line">        System.out.println(<span class="string">"Sum of all Shape2D is "</span>+sum(data));</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="final-修飾字"><a href="#final-修飾字" class="headerlink" title="final 修飾字"></a>final 修飾字</h2><p><code>final</code> 除可用來修飾變數外，也可放在 class 和 object method 前面：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">FinalClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">finalMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>放在 <code>class</code> 前面表示 class 不可被繼承，放在 object method 表示不可被 Override。</p>
<h2 id="繼承關係下的-Constructor-執行順序"><a href="#繼承關係下的-Constructor-執行順序" class="headerlink" title="繼承關係下的 Constructor 執行順序"></a>繼承關係下的 Constructor 執行順序</h2><ul>
<li>先將所有變數設為內定值。對數值型態來說，其值為 0；對 reference 來說，其值為 <code>null</code>；對 boolean 來說，其值為 <code>false</code>。</li>
<li>呼叫父類別的 constructor。如果子類別 Constructor 裡沒有指定父類別的 Constructor，則使用父類別沒有參數的 Constructor。</li>
<li>執行變數宣告的初始化動作。</li>
<li>執行自己的 constructor。</li>
</ul>
<p>如果要指定父類別其他的 constructor，則必須在子類別的 constructor 的第一行使用關鍵字 <code>super</code> 來處理。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> aMask = <span class="number">0x00FF</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Animal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Animal</span><span class="params">(<span class="keyword">int</span> mask)</span> </span>&#123;</span><br><span class="line">        aMask = mask;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> bMask = <span class="number">0xFF00</span>;</span><br><span class="line">    <span class="keyword">int</span> fullMask;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bird</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Compiler add super() here</span></span><br><span class="line">        fullMask = bMask | aMask;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bird</span><span class="params">(<span class="keyword">int</span> mask)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/* 若有super,則必須放在第一行,連變數宣告也不能擺在super前面 */</span></span><br><span class="line">        <span class="keyword">super</span>(mask);</span><br><span class="line">        fullMask = bMask | aMask;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span> </span>&#123;</span><br><span class="line">        Bird b = <span class="keyword">new</span> Bird();</span><br><span class="line">        System.out.println(b.fullMask);</span><br><span class="line">        b = <span class="keyword">new</span> Bird(<span class="number">0x0011</span>);</span><br><span class="line">        System.out.println(b.fullMask);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>當執行 <code>new Bird()</code> 時，此物件內各個變數的變化如下</p>
<table>
<thead>
<tr>
<th style="text-align:left">步驟</th>
<th style="text-align:left">aMask</th>
<th style="text-align:left">bMask</th>
<th style="text-align:left">fullMask</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">default</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">call Bird()</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">call Animal()</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">Animal initialize</td>
<td style="text-align:left">0x00FF</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">execute Animal()</td>
<td style="text-align:left">0x00FF</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">Bird initialize</td>
<td style="text-align:left">0x00FF</td>
<td style="text-align:left">0xFF00</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">execute Bird()</td>
<td style="text-align:left">0x00FF</td>
<td style="text-align:left">0xFF00</td>
<td style="text-align:left">0xFFFF</td>
</tr>
</tbody>
</table>
<p>當執行 <code>new Bird(0x0011)</code> 時，此物件內各個變數的變化如下</p>
<table>
<thead>
<tr>
<th style="text-align:left">步驟</th>
<th style="text-align:left">aMask</th>
<th style="text-align:left">bMask</th>
<th style="text-align:left">fullMask</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">default</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">call Bird(0x0011)</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">call Animal(0x0011)</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">Animal initialize</td>
<td style="text-align:left">0x00FF</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">execute Animal(0x0011)</td>
<td style="text-align:left">0x0011</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">Bird initialize</td>
<td style="text-align:left">0x0011</td>
<td style="text-align:left">0xFF00</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">execute Bird(0x0011)</td>
<td style="text-align:left">0x0011</td>
<td style="text-align:left">0xFF00</td>
<td style="text-align:left">0xFF11</td>
</tr>
</tbody>
</table>

        <div id="react-support-footer-root"></div>
      </div>
    </div>
  </div>
</div>

    


    

    <!-- js vendors -->
    <script src="//code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/2.1.0/lunr.min.js"></script>

    <!-- js source  -->
    <script src="/script/doc.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    

  </body>
</html>
