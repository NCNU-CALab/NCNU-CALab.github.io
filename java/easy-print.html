<!DOCTYPE html>
<html lang="zh">
  <head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">

    <title>SSYU 的書們 | 印表 </title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <!-- fonts -->
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,600,700" rel="stylesheet">

    <!-- stylesheets -->
    <link rel="stylesheet" href="/style/doc.css">

    <!-- favicon -->
    <link rel="icon" href="/images/favicon.ico"><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    

  </head>
  <body>

   <!-- hexo-inject:begin --><!-- hexo-inject:end --><script>window.__INITIAL_STATE__ = {"page":{"title":"印表","path":"java/easy-print.html"},"data":{"navigation":{"logo":{"text":"Programming Yu","type":"link","path":"index.html"},"main":[{"text":"C 程式語言教學","type":"label","children":[{"text":"程式寫作概論","type":"link","path":"c/writing-intro.html"},{"text":"電腦系統概論","type":"link","path":"c/system-intro.html"},{"text":"電腦內部運作","type":"link","path":"c/system-operation.html"},{"text":"C 語言的總覽","type":"link","path":"c/c-intro.html"}]},{"text":"C 程式語言範例","type":"label","children":[{}]},{"text":"Java 程式語言教學","type":"label","children":[{"text":"Java 與 C 的比較","type":"link","path":"java/java-vs-c.html"},{"text":"類別與物件","type":"link","path":"java/class-and-obj.html"},{"text":"陣列","type":"link","path":"java/array.html"},{"text":"封裝","type":"link","path":"java/encapsulation.html"},{"text":"訊息傳遞","type":"link","path":"java/message-passing.html"},{"text":"繼承","type":"link","path":"java/extends.html"},{"text":"介面","type":"link","path":"java/interface.html"},{"text":"例外處理","type":"link","path":"java/exception.html"},{"text":"線串與同步處理","type":"link","path":"java/thread.html"},{"text":"容器類別","type":"link","path":"java/container.html"},{"text":"GUI","type":"link","path":"java/gui.html"},{"text":"IO","type":"link","path":"java/io.html"},{"text":"NET","type":"link","path":"java/net.html"},{"text":"JDBC","type":"link","path":"java/jdbc.html"},{"text":"印表","type":"link","path":"java/easy-print.html"}]},{"text":"Java 程式語言範例","type":"label","children":[{"text":"所得稅計算","type":"link","path":"java/examples/tax-calculate.html"}]},{"text":"資料結構與演算法","type":"label"}]},"posts":[{"text":"The 3n + 1 problem","type":"link","path":"questions/The-3n-1-problem/","date":"2017-12-21T19:53:25+00:00"}]},"config":{"timezone":"Asia/Taipei","root":"/","time_format":"HH:mm:ss","theme":"doc","theme_config":{"swagger_ui":{"version":2,"permalinks":true,"api_explorer":true,"download":"Download specification","show_extensions":false,"deep_linking":true,"display_operation_id":false,"doc_expansion":"none"},"search":{"skip":false,"background":false,"route":"/lunr.json"},"favicon":"images/favicon.ico"}}}</script>

    <div id="react-navigation-root"><div class="doc-navigation" data-reactroot=""><nav class="doc-navbar"><a href="/index.html" class="doc-navbar__logo"><img src="/images/logo.png" class="doc-navbar__logo__img"/><span class="doc-navbar__logo__text">Programming Yu</span></a><i class="dc-icon dc-icon--close dc-icon--interactive doc-sidebar-close doc-navbar__sidebar-close doc-navbar__sidebar-close--desktop"></i><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-navbar__sidebar-toggle"></i></nav><nav class="doc-sidebar"><div class="doc-sidebar__vertical-menu"><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-sidebar-toggle--primary doc-sidebar__vertical-menu__item"></i><i class="dc-icon dc-icon--search dc-icon--interactive doc-sidebar__vertical-menu__item doc-sidebar__vertical-menu__item--primary"></i></div><div class="doc-sidebar-content"><div class="doc-sidebar__search-form"></div><ul class="doc-sidebar-list"></ul></div></nav></div></div>
    <div class="doc-content">
  <div class="dc-page">
    <div class="dc-card">
      <div id="react-search-results-root"></div>
      <div id="page-content" class="doc-formatting">
        <h1>印表</h1>
        <p>JDK 對印表的支援不多，主要是以「所視即所得」的觀念，將 AWT 的原先利用 Graphics 繪圖的部分改為利用 PrintGraphics，即可達到印表的需求。  </p>
<p>以下是一個提供預覽以及背景列印的程式庫，該程式庫採用 <a href="http://www.javacamp.org/designPattern/" target="_blank" rel="noopener">Template Design Pattern</a>，透過 abstract methods 要求子類別必須實作特定的方法。  </p>
<p>本程式另將原始碼公開於 <a href="https://github.com/NCNU-CALab/EasyPrint" target="_blank" rel="noopener">GitHub</a> 歡迎指教  </p>
<h2 id="Print-java"><a href="#Print-java" class="headerlink" title="Print.java"></a>Print.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ncnu.print;</span><br><span class="line"><span class="comment">/* Program Name: Print.java</span></span><br><span class="line"><span class="comment">   Subject: 印表與瀏覽抽象類別 </span></span><br><span class="line"><span class="comment">   Editor: 俞旭昇 Shiuh-Sheng Yu</span></span><br><span class="line"><span class="comment">           National ChiNan University</span></span><br><span class="line"><span class="comment">           Department of Information Management</span></span><br><span class="line"><span class="comment">   Edit Date: 01/05/1998</span></span><br><span class="line"><span class="comment">   Modify Date: 05/06/2001</span></span><br><span class="line"><span class="comment">   Modify Date: 2004/10/01,加入背景列印</span></span><br><span class="line"><span class="comment">   ToolKit: JDK1.1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">import</span> ncnu.gui.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.*;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Print</span> <span class="keyword">implements</span> <span class="title">ActionListener</span> </span>&#123;</span><br><span class="line">    ScrollPane sp;</span><br><span class="line">    <span class="keyword">protected</span> Connection con;</span><br><span class="line">    <span class="keyword">protected</span> SimpleTable fg;</span><br><span class="line">    <span class="keyword">protected</span> TableGUI gui;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> completed = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">protected</span> String printer;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> copy = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">boolean</span> background;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Print</span><span class="params">(Connection c, String printer, <span class="keyword">int</span> copy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.con = c;</span><br><span class="line">        <span class="keyword">this</span>.printer = printer;</span><br><span class="line">        <span class="keyword">this</span>.copy = copy;</span><br><span class="line">        <span class="keyword">this</span>.background = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Print</span><span class="params">(Connection c, Vector data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.con = c;</span><br><span class="line">        <span class="keyword">if</span> (data != <span class="keyword">null</span>) &#123;</span><br><span class="line">            PrintCanvas canvas = createCanvas(data);</span><br><span class="line">            canvas.setResolution(<span class="number">144</span>);</span><br><span class="line">            <span class="keyword">new</span> Preview(canvas,<span class="string">"預覽報表"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            fg = <span class="keyword">new</span> SimpleTable(<span class="string">""</span>, <span class="keyword">this</span>, <span class="number">16</span>);</span><br><span class="line">            addQueryCondition();</span><br><span class="line">            fg.addButton(<span class="string">"確定"</span>);</span><br><span class="line">            fg.addButton(<span class="string">"取消"</span>);</span><br><span class="line">            <span class="keyword">if</span> (completed) &#123;</span><br><span class="line">                fg.addButton(<span class="string">"預覽"</span>);</span><br><span class="line">                fg.addButton(<span class="string">"放大預覽"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            fg.read();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Print</span><span class="params">(Connection c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(c, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> Vector <span class="title">getData</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> PrintCanvas <span class="title">createCanvas</span><span class="params">(Vector data)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addQueryCondition</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setPrinter</span><span class="params">(String pname)</span> </span>&#123;</span><br><span class="line">        printer = pname;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Vector data = getData();</span><br><span class="line">        <span class="keyword">if</span> (data==<span class="keyword">null</span> || data.size()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        PrintCanvas canvas = createCanvas(data);</span><br><span class="line">        canvas.setResolution(<span class="number">72</span>);</span><br><span class="line">        PrintJob pjob = getPrintJob(canvas);</span><br><span class="line">        <span class="keyword">if</span> (pjob != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                Graphics pg = pjob.getGraphics();</span><br><span class="line">                canvas.update(pg);</span><br><span class="line">                pg.dispose(); <span class="comment">// flush page</span></span><br><span class="line">            &#125; <span class="keyword">while</span> (canvas.nextPage());</span><br><span class="line">            pjob.end();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"Unable to create print job "</span>+printer);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> PrintJob <span class="title">getPrintJob</span><span class="params">(PrintCanvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (System.getProperty(<span class="string">"java.version"</span>).compareTo(<span class="string">"1.3"</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> gui.getToolkit().getPrintJob(fg, <span class="string">"列印報表"</span>, <span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            PageAttributes pa = <span class="keyword">new</span> PageAttributes();</span><br><span class="line">            String media = canvas.getMedia();</span><br><span class="line">            <span class="keyword">if</span> (media.equalsIgnoreCase(<span class="string">"letter"</span>)) &#123;</span><br><span class="line">                pa.setMedia(PageAttributes.MediaType.LETTER);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (media.equalsIgnoreCase(<span class="string">"B4"</span>)) &#123;</span><br><span class="line">                pa.setMedia(PageAttributes.MediaType.JIS_B4);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (media.equalsIgnoreCase(<span class="string">"A4"</span>)) &#123;</span><br><span class="line">                pa.setMedia(PageAttributes.MediaType.A4);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (media.equalsIgnoreCase(<span class="string">"A3"</span>)) &#123;</span><br><span class="line">                pa.setMedia(PageAttributes.MediaType.A3);</span><br><span class="line">            &#125;</span><br><span class="line">            String ori = canvas.getOrientation();</span><br><span class="line">            <span class="keyword">if</span> (ori.equalsIgnoreCase(<span class="string">"portraint"</span>)) &#123;</span><br><span class="line">                pa.setOrientationRequested(PageAttributes.OrientationRequestedType.PORTRAIT);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ori.equalsIgnoreCase(<span class="string">"landscape"</span>)) &#123;</span><br><span class="line">                pa.setOrientationRequested(PageAttributes.OrientationRequestedType.LANDSCAPE);</span><br><span class="line">            &#125;</span><br><span class="line">            JobAttributes jAttr = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (printer!=<span class="keyword">null</span>) &#123;</span><br><span class="line">                jAttr = <span class="keyword">new</span> JobAttributes();</span><br><span class="line">                jAttr.setDialog(JobAttributes.DialogType.NONE);</span><br><span class="line">                jAttr.setPrinter(printer);</span><br><span class="line">                jAttr.setCopies(copy);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (background) &#123;</span><br><span class="line">                <span class="keyword">return</span> Toolkit.getDefaultToolkit().getPrintJob(<span class="keyword">null</span>, <span class="string">"列印報表"</span>, jAttr, pa);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> gui.getToolkit().getPrintJob(fg, <span class="string">"列印報表"</span>, jAttr, pa);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">        PrintCanvas canvas;</span><br><span class="line">        String returnString, query;</span><br><span class="line">        String cmd = e.getActionCommand();</span><br><span class="line">        <span class="keyword">if</span> (cmd.equals(<span class="string">"取消"</span>)) &#123;</span><br><span class="line">            fg.dispose();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Vector data = getData();</span><br><span class="line">        <span class="keyword">if</span> (data==<span class="keyword">null</span> || data.size()==<span class="number">0</span>) &#123;</span><br><span class="line">            fg.dispose();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!completed) &#123;</span><br><span class="line">            addQueryCondition();</span><br><span class="line">            <span class="keyword">if</span> (completed) &#123;</span><br><span class="line">                fg.addButton(<span class="string">"預覽"</span>);</span><br><span class="line">                fg.addButton(<span class="string">"放大預覽"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            fg.read();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cmd.equals(<span class="string">"確定"</span>)) &#123;</span><br><span class="line">            canvas = createCanvas(data);</span><br><span class="line">            canvas.setResolution(<span class="number">72</span>);</span><br><span class="line">            PrintJob pjob = getPrintJob(canvas);</span><br><span class="line">            <span class="keyword">if</span> (pjob != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    Graphics pg = pjob.getGraphics();</span><br><span class="line">                    canvas.update(pg);</span><br><span class="line">                    pg.dispose(); <span class="comment">// flush page</span></span><br><span class="line">                &#125; <span class="keyword">while</span> (canvas.nextPage());</span><br><span class="line">                pjob.end();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">"User canceled job"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            fg.dispose();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            canvas = createCanvas(data);</span><br><span class="line">            <span class="keyword">if</span> (cmd.equals(<span class="string">"預覽"</span>)) &#123;</span><br><span class="line">                canvas.setResolution(<span class="number">72</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmd.equals(<span class="string">"放大預覽"</span>)) &#123;</span><br><span class="line">                canvas.setResolution(<span class="number">144</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">new</span> Preview(canvas,<span class="string">"預覽報表"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Preview</span> <span class="keyword">extends</span> <span class="title">WindowAdapter</span> <span class="keyword">implements</span> <span class="title">ActionListener</span> </span>&#123;</span><br><span class="line">        Frame f;</span><br><span class="line">        Button previous, next, printOne, printAll, leave;</span><br><span class="line">        PrintJob pjob = <span class="keyword">null</span>;</span><br><span class="line">        String title;</span><br><span class="line">        PrintCanvas pc;</span><br><span class="line">        ScrollPane sp = <span class="keyword">new</span> ScrollPane() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> Dimension <span class="title">getPreferredSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                Dimension x = Toolkit.getDefaultToolkit().getScreenSize();</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension(x.width-<span class="number">20</span>,x.height-<span class="number">50</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">            String cmd = e.getActionCommand();</span><br><span class="line">            <span class="keyword">if</span> (cmd.equals(<span class="string">"上一頁"</span>)) &#123;</span><br><span class="line">                doPrevious();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmd.equals(<span class="string">"下一頁"</span>)) &#123;</span><br><span class="line">                doNext();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmd.equals(<span class="string">"列印本頁"</span>)) &#123;</span><br><span class="line">                doPrintOne();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmd.equals(<span class="string">"列印全部"</span>)) &#123;</span><br><span class="line">                doPrintAll();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">"Unknown command "</span>+cmd);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;        </span><br><span class="line">        Preview(PrintCanvas pc, String title) &#123;</span><br><span class="line">            <span class="keyword">this</span>.pc = pc;</span><br><span class="line">            <span class="keyword">this</span>.title = title;</span><br><span class="line">            f = <span class="keyword">new</span> Frame(title);</span><br><span class="line">            f.setLayout(<span class="keyword">new</span> GridBagLayout());</span><br><span class="line">            f.addWindowListener(<span class="keyword">new</span> CloseWindow(f));</span><br><span class="line">            sp.add(pc);</span><br><span class="line">            AddConstraint.addConstraint(f,sp,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">                GridBagConstraints.BOTH, GridBagConstraints.CENTER,</span><br><span class="line">                <span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            Panel buttons = <span class="keyword">new</span> Panel();</span><br><span class="line">            buttons.setLayout(<span class="keyword">new</span> GridLayout(<span class="number">1</span>,<span class="number">5</span>));</span><br><span class="line">            AddConstraint.addConstraint(f,buttons,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">                GridBagConstraints.HORIZONTAL, GridBagConstraints.CENTER,</span><br><span class="line">                <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            ((Button)buttons.add(previous=<span class="keyword">new</span> Button(<span class="string">"上一頁"</span>))).addActionListener(<span class="keyword">this</span>);</span><br><span class="line">            ((Button))buttons.add(next=<span class="keyword">new</span> Button(<span class="string">"下一頁"</span>))).addActionListener(<span class="keyword">this</span>);</span><br><span class="line">            ((Button))buttons.add(printOne=<span class="keyword">new</span> Button(<span class="string">"列印本頁"</span>))).addActionListener(<span class="keyword">this</span>);</span><br><span class="line">            ((Button))buttons.add(printAll=<span class="keyword">new</span> Button(<span class="string">"列印全部"</span>))).addActionListener(<span class="keyword">this</span>);</span><br><span class="line">            ((Button))buttons.add(leave=<span class="keyword">new</span> Button(<span class="string">"離開"</span>))).addActionListener(<span class="keyword">new</span> CloseWindow(f));</span><br><span class="line">            previous.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">            <span class="keyword">if</span> (pc.lastPage()) &#123;</span><br><span class="line">                next.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            f.pack();</span><br><span class="line">            f.show();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">doPrevious</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            pc.previousPage();</span><br><span class="line">            <span class="keyword">if</span> (pc.firstPage()) &#123;</span><br><span class="line">                previous.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (pc.lastPage()) &#123;</span><br><span class="line">                next.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                next.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            pc.update(pc.getGraphics());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">doNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            pc.nextPage();</span><br><span class="line">            <span class="keyword">if</span> (pc.lastPage()) &#123;</span><br><span class="line">                next.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (pc.firstPage()) &#123;</span><br><span class="line">                previous.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                previous.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            pc.update(pc.getGraphics());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">doPrintOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (pjob==<span class="keyword">null</span>) &#123;</span><br><span class="line">                pjob = Print.<span class="keyword">this</span>.getPrintJob(pc);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (pjob != <span class="keyword">null</span>) &#123;</span><br><span class="line">                Graphics pg = pjob.getGraphics();</span><br><span class="line">                pc.buffer = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">int</span> rel = pc.getResolution();</span><br><span class="line">                pc.setResolution(<span class="number">72</span>);</span><br><span class="line">                pc.update(pg);</span><br><span class="line">                pg.dispose(); <span class="comment">// flush page</span></span><br><span class="line">                pjob.end();</span><br><span class="line">                pjob=<span class="keyword">null</span>;</span><br><span class="line">                pc.setResolution(rel);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">doPrintAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (pjob==<span class="keyword">null</span>) &#123;</span><br><span class="line">                pjob = Print.<span class="keyword">this</span>.getPrintJob(pc);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (pjob != <span class="keyword">null</span>) &#123;</span><br><span class="line">                pc.currentPage = -<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (pc.nextPage()) &#123;</span><br><span class="line">                    Graphics pg = pjob.getGraphics();</span><br><span class="line">                    pc.buffer = <span class="keyword">null</span>;</span><br><span class="line">                    pc.setResolution(<span class="number">72</span>);</span><br><span class="line">                    pc.update(pg);</span><br><span class="line">                    pg.dispose();</span><br><span class="line">                &#125;</span><br><span class="line">                pjob.end();</span><br><span class="line">                pjob=<span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="PrintCanvas-java"><a href="#PrintCanvas-java" class="headerlink" title="PrintCanvas.java"></a>PrintCanvas.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ncnu.print;</span><br><span class="line"><span class="comment">/* Program Name: PrintCanvas.java</span></span><br><span class="line"><span class="comment">   Subject: 印表畫布抽象類別 </span></span><br><span class="line"><span class="comment">   Editor: 俞旭昇 Shiuh-Sheng Yu</span></span><br><span class="line"><span class="comment">           National Chi-Nan University</span></span><br><span class="line"><span class="comment">           Institute of Management Information </span></span><br><span class="line"><span class="comment">   Edit Date: 01/05/1998</span></span><br><span class="line"><span class="comment">   Last Update Date: 05/06/2001</span></span><br><span class="line"><span class="comment">   ToolKit: JDK1.1.4</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintCanvas</span> <span class="keyword">extends</span> <span class="title">Canvas</span> </span>&#123;</span><br><span class="line">    Image buffer;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> total;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> dotPerInch=<span class="number">72</span>;</span><br><span class="line">    <span class="keyword">protected</span> Vector data;</span><br><span class="line">    <span class="keyword">protected</span>&gt; <span class="keyword">int</span> currentPage;</span><br><span class="line">    <span class="keyword">protected</span> Pair pagePositions[]; <span class="comment">// cached for previous page</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Pair</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> data, subpage;</span><br><span class="line">        Pair(<span class="keyword">int</span> data, <span class="keyword">int</span> subpage) &#123;</span><br><span class="line">            <span class="keyword">this</span>.data = data;</span><br><span class="line">            <span class="keyword">this</span>.subpage = subpage;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setResolution</span><span class="params">(<span class="keyword">int</span> rel)</span> </span>&#123;</span><br><span class="line">        dotPerInch=rel;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getResolution</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dotPerInch;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDataIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pagePositions[currentPage].data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSubPageIndex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pagePositions[currentPage].subpage;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">totalPages</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; data.size();) &#123;</span><br><span class="line">            <span class="keyword">int</span> sub = pagesPerData(data.elementAt(i));</span><br><span class="line">            <span class="keyword">if</span> (sub&gt;<span class="number">1</span>) &#123; <span class="comment">// multi page per data</span></span><br><span class="line">                total += sub;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                i += dataPerPage(total);</span><br><span class="line">                total++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">dataPerPage</span><span class="params">(<span class="keyword">int</span> pageNum)</span></span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * How many pages are needed to print out data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data Data record to be printed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Number of pages for the data, 0 if more data are need to fill this page</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">pagesPerData</span><span class="params">(Object data)</span></span>; <span class="comment">// return 0 if more than a page per record</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * print a page for a data record</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pg Print graphics</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data Data record to be printed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrintCanvas</span><span class="params">(Vector data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">        currentPage=<span class="number">0</span>;</span><br><span class="line">        total = totalPages();</span><br><span class="line">        pagePositions = <span class="keyword">new</span> Pair[total];</span><br><span class="line">        <span class="keyword">int</span> currentData = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; total;) &#123;</span><br><span class="line">            <span class="keyword">int</span> sub = pagesPerData(data.elementAt(currentData));</span><br><span class="line">            <span class="keyword">if</span> (sub&gt;<span class="number">1</span>) &#123; <span class="comment">// multi page per data</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j &lt; sub; j++) &#123;</span><br><span class="line">                    pagePositions[i+j] = <span class="keyword">new</span> Pair(currentData,j);</span><br><span class="line">                &#125;</span><br><span class="line">                i+=sub;</span><br><span class="line">                currentData++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// multi data per page</span></span><br><span class="line">                pagePositions[i] = <span class="keyword">new</span> Pair(currentData,<span class="number">0</span>);</span><br><span class="line">                currentData += dataPerPage(i);</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dimension <span class="title">getPreferredSize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (getMedia().equals(<span class="string">"A4"</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (getOrientation().equals(<span class="string">"portrait"</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">8.27</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">11.69</span>*dotPerInch)); <span class="comment">// A4 直印</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">11.69</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.27</span>*dotPerInch)); <span class="comment">// A4 橫印</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getMedia().equals(<span class="string">"B4"</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (getOrientation().equals(<span class="string">"portrait"</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">9.84</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">13.9</span>*dotPerInch)); <span class="comment">// B4 直印</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">13.9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.84</span>*dotPerInch)); <span class="comment">// B4 橫印</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getMedia().equals(<span class="string">"A3"</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (getOrientation().equals(<span class="string">"portrait"</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">11.69</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">16.54</span>*dotPerInch)); <span class="comment">// A3 直印</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">16.54</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">11.69</span>*dotPerInch)); <span class="comment">// A3 橫印</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (getMedia().equals(<span class="string">"LETTER"</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (getOrientation().equals(<span class="string">"portrait"</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">8.5</span>*dotPerInch), (<span class="keyword">int</span>)(<span class="number">11</span>*dotPerInch)); <span class="comment">// letter 直印</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">11</span>*dotPerInch), (<span class="keyword">int</span>)(<span class="number">8.5</span>*dotPerInch)); <span class="comment">// letter 橫印</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Dimension((<span class="keyword">int</span>)(<span class="number">8</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">11.2</span>*dotPerInch)); <span class="comment">// A4 直印 size</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMedia</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"A4"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getOrientation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"portrait"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">firstPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (currentPage&lt;=<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lastPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ((currentPage+<span class="number">1</span>)&gt;=total);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">nextPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (currentPage+<span class="number">1</span>&gt;=total) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        buffer=<span class="keyword">null</span>;</span><br><span class="line">        currentPage++;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">previousPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (currentPage == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        buffer=<span class="keyword">null</span>;</span><br><span class="line">        currentPage--;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Graphics pg)</span> </span>&#123;</span><br><span class="line">        Graphics g = pg;</span><br><span class="line">        <span class="keyword">if</span> (buffer!=<span class="keyword">null</span>) &#123;</span><br><span class="line">            pg.drawImage(buffer,<span class="number">0</span>,<span class="number">0</span>,<span class="keyword">this</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!(pg <span class="keyword">instanceof</span> PrintGraphics)) &#123;</span><br><span class="line">            Dimension d = getPreferredSize();</span><br><span class="line">            buffer = createImage(d.width, d.height);</span><br><span class="line">            <span class="keyword">if</span> (buffer!=<span class="keyword">null</span>) &#123;</span><br><span class="line">                g = buffer.getGraphics();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        paint(g);</span><br><span class="line">        <span class="keyword">if</span> (buffer!=<span class="keyword">null</span>) &#123;</span><br><span class="line">            pg.drawImage(buffer,<span class="number">0</span>,<span class="number">0</span>,<span class="keyword">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="圖形與字型公用程式"><a href="#圖形與字型公用程式" class="headerlink" title="圖形與字型公用程式"></a>圖形與字型公用程式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> ncnu.print;</span><br><span class="line"><span class="comment">/* Program Name: CharArea.java</span></span><br><span class="line"><span class="comment">   Subject: 印表公用程式 </span></span><br><span class="line"><span class="comment">   Editor: 俞旭昇 Shiuh-Sheng Yu</span></span><br><span class="line"><span class="comment">           National Chi-Nan University</span></span><br><span class="line"><span class="comment">           Institute of Management Information </span></span><br><span class="line"><span class="comment">   Edit Date: 01/05/1998</span></span><br><span class="line"><span class="comment">   Last Update Date: 05/06/2001</span></span><br><span class="line"><span class="comment">   ToolKit: JDK1.1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The class defines a rectangle area so that users can draw String vertically or</span></span><br><span class="line"><span class="comment"> * horizontally, and don't have to worry wrapping problem.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CharArea</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Graphics g;</span><br><span class="line">    <span class="keyword">private</span> FontMetrics f;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> x, y, width, height, row, col;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> curx, cury;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> fromRight;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> fontHeight;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> g Graphics to draw String</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x x coordinate of the area in points</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> y y coordinate of the area in points</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> width width of the area in points</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> height height of the area in points</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fromRight draw Lines from right or not</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CharArea</span><span class="params">(Graphics g, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> width, <span class="keyword">int</span> height, <span class="keyword">boolean</span> fromRight)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.g = g;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">        <span class="keyword">this</span>.width = width;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">        <span class="keyword">this</span>.fromRight = fromRight;</span><br><span class="line">        col = row = <span class="number">1</span>;</span><br><span class="line">        f = g.getFontMetrics();</span><br><span class="line">        <span class="comment">// expect font size</span></span><br><span class="line">        <span class="keyword">if</span> (System.getProperty(<span class="string">"java.version"</span>).compareTo(<span class="string">"1.4"</span>) &gt;=<span class="number">0</span>) &#123;</span><br><span class="line">            fontHeight = (<span class="keyword">int</span>)(f.getAscent()*<span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            fontHeight = (<span class="keyword">int</span>)(f.getAscent()*<span class="number">1.2857</span>); <span class="comment">// 9/7 for strange differece between 1.3 and 1.4 fontMetrics</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!fromRight) &#123;</span><br><span class="line">            curx = x;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            curx = x + width - fontHeight;</span><br><span class="line">        &#125;</span><br><span class="line">        cury = y + fontHeight;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> g Graphics to draw String</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> x x coordinate of the area in points</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> y y coordinate of the area in points</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> width width of the area in points</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> height height of the area in points</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CharArea</span><span class="params">(Graphics g, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(g, x, y, width, height, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        col and row starts from 1</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getRow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> row;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRow</span><span class="params">(<span class="keyword">int</span> row)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.row = row;</span><br><span class="line">        cury = y + row*fontHeight;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCol</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> col;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCol</span><span class="params">(<span class="keyword">int</span> col)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.col = col;</span><br><span class="line">        curx = x + (col-<span class="number">1</span>)*f.getHeight(); <span class="comment">// assume 方塊字</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Draw a string vertically, and wrap to right if necessary. Reset row to 1 after drawing.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawLineV</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s==<span class="keyword">null</span> || s.length()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        drawV(s);</span><br><span class="line">        col = col + <span class="number">1</span>;</span><br><span class="line">        row = <span class="number">1</span>;</span><br><span class="line">        curx += f.getHeight(); <span class="comment">// assume 方塊字</span></span><br><span class="line">        cury = y + fontHeight;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Draw a string vertically, wrap to right if necessary.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawV</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, strlen;</span><br><span class="line">        <span class="keyword">char</span>[] chars;</span><br><span class="line">        <span class="keyword">if</span> (s==<span class="keyword">null</span> || s.length()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        strlen = s.length();</span><br><span class="line">        chars = <span class="keyword">new</span> <span class="keyword">char</span>[strlen];</span><br><span class="line">        s.getChars(<span class="number">0</span>,strlen,chars,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; strlen; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((cury-y) &gt; height) &#123;</span><br><span class="line">                cury = y + fontHeight;</span><br><span class="line">                col++;</span><br><span class="line">                row = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (fromRight) &#123;</span><br><span class="line">                    curx -= f.getHeight();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    curx += f.getHeight();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            g.drawChars(chars,i,<span class="number">1</span>,curx,cury);</span><br><span class="line">            cury +=fontHeight;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Draw a string horizontally, wrap down if necessary. Rest col to 1 after drawing.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawLineH</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s==<span class="keyword">null</span> || s.length()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        drawH(s);</span><br><span class="line">        col = <span class="number">1</span>;</span><br><span class="line">        row = row + <span class="number">1</span>;</span><br><span class="line">        curx = x;</span><br><span class="line">        cury += fontHeight;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Draw a String horizontally, wrap down if necessary.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawH</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, strlen;</span><br><span class="line">        <span class="keyword">char</span>[] chars;</span><br><span class="line">        <span class="keyword">if</span> (s==<span class="keyword">null</span> || s.length()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        strlen = s.length();</span><br><span class="line">        chars = <span class="keyword">new</span> <span class="keyword">char</span>[strlen];</span><br><span class="line">        s.getChars(<span class="number">0</span>,strlen,chars,<span class="number">0</span>);</span><br><span class="line">        f = g.getFontMetrics();</span><br><span class="line">        <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; strlen; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (chars[i]==<span class="string">'\n'</span>) &#123;</span><br><span class="line">               curx = x;</span><br><span class="line">               col = <span class="number">1</span>;</span><br><span class="line">               row = row + <span class="number">1</span>;</span><br><span class="line">               cury += fontHeight;</span><br><span class="line">               <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (((curx-x)+f.charWidth(chars[i])) &gt; width) &#123;</span><br><span class="line">                curx = x;</span><br><span class="line">                col = <span class="number">1</span>;</span><br><span class="line">                row = row + <span class="number">1</span>;</span><br><span class="line">                cury += fontHeight;</span><br><span class="line">            &#125;</span><br><span class="line">            g.drawChars(chars,i,<span class="number">1</span>,curx,cury);</span><br><span class="line">            curx += f.charWidth(chars[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Fill a string vertically in the specified area, with proper space between characters.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">fillV</span><span class="params">(Graphics g, String s, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> vlen, hlen, i, strlen;</span><br><span class="line">        FontMetrics f;</span><br><span class="line">        <span class="keyword">double</span> scale, currentPos;</span><br><span class="line">        <span class="keyword">char</span>[] chars;</span><br><span class="line">        <span class="keyword">if</span> (s==<span class="keyword">null</span> || s.length()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        f = g.getFontMetrics();</span><br><span class="line">        strlen = s.length();</span><br><span class="line">        vlen = f.getHeight();</span><br><span class="line">        chars = <span class="keyword">new</span> <span class="keyword">char</span>[strlen];</span><br><span class="line">        s.getChars(<span class="number">0</span>,strlen,chars,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (strlen == <span class="number">1</span>) &#123;</span><br><span class="line">            g.drawString(s,(<span class="keyword">int</span>)(x+(width-f.charWidth(chars[<span class="number">0</span>])+<span class="number">1</span>)/<span class="number">2</span>),(<span class="keyword">int</span>)(y+(height-vlen)/<span class="number">2</span>+f.getHeight()));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            scale = (<span class="keyword">double</span>)(height-vlen*strlen)/(strlen);</span><br><span class="line">            <span class="keyword">for</span> (i=<span class="number">0</span>, currentPos=y+f.getHeight()+scale/<span class="number">2</span>; i &lt; strlen; i++) &#123;</span><br><span class="line">                g.drawChars(chars,i,<span class="number">1</span>,(<span class="keyword">int</span>)(x+(width-f.charWidth(chars[i])+<span class="number">1</span>)/<span class="number">2</span>),(<span class="keyword">int</span>)currentPos);</span><br><span class="line">                currentPos += scale + vlen;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">drawCenter</span><span class="params">(Graphics g, String s, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len, i, strlen;</span><br><span class="line">        FontMetrics f;</span><br><span class="line">        <span class="keyword">if</span> (s==<span class="keyword">null</span> || s.length()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        f = g.getFontMetrics();</span><br><span class="line">        len = f.stringWidth(s);</span><br><span class="line">        g.drawString(s,x-(len+<span class="number">1</span>)/<span class="number">2</span>,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Fill a string horizontally in the specified area, with proper space between characters.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">fillH</span><span class="params">(Graphics g, String s, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len, i, strlen;</span><br><span class="line">        FontMetrics f;</span><br><span class="line">        <span class="keyword">if</span> (s==<span class="keyword">null</span> || s.length()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        f = g.getFontMetrics();</span><br><span class="line">        len = f.stringWidth(s);</span><br><span class="line">        strlen = s.length();</span><br><span class="line">        <span class="keyword">if</span> (strlen==<span class="number">1</span>) &#123;</span><br><span class="line">            len=f.stringWidth(s);</span><br><span class="line">            g.drawString(s,(<span class="keyword">int</span>)(x+(width-len+<span class="number">1</span>)/<span class="number">2</span>),y+(height+f.getHeight())/<span class="number">2</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">char</span>[] chars = <span class="keyword">new</span> <span class="keyword">char</span>[strlen];</span><br><span class="line">            s.getChars(<span class="number">0</span>,strlen,chars,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span> (i=<span class="number">0</span>, len=<span class="number">0</span>; i &lt; strlen; i++) &#123;</span><br><span class="line">                len += f.charWidth(chars[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">double</span> scale = ((<span class="keyword">double</span>)(width-len))/(strlen);</span><br><span class="line">            <span class="keyword">double</span> currentPoint;</span><br><span class="line">            y += (height+f.getHeight())/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">for</span> (i=<span class="number">0</span>, currentPoint=x+(scale+<span class="number">1</span>)/<span class="number">2</span>; i &lt; strlen; i++) &#123;</span><br><span class="line">                g.drawChars(chars,i,<span class="number">1</span>,(<span class="keyword">int</span>)currentPoint,y);</span><br><span class="line">                currentPoint += scale + f.charWidth(chars[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="印表範例"><a href="#印表範例" class="headerlink" title="印表範例"></a>印表範例</h2><p>使用以上類別的印表程式 <code>PrintYLNoticeA4.java</code>  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Program Name: PrintYLNoticeA4.java</span></span><br><span class="line"><span class="comment"> *    Subject: 列印學期成績單通知單(A4紙版本)</span></span><br><span class="line"><span class="comment"> *    Author: Shiuh-Sheng Yu</span></span><br><span class="line"><span class="comment"> *    Edit Date: 01/13/2001</span></span><br><span class="line"><span class="comment"> *    Last Update Date: 02/06/2002</span></span><br><span class="line"><span class="comment"> *    Last Update Date: 06/12/2003 add 停修</span></span><br><span class="line"><span class="comment"> *    Modify Date: 2004/07/07 加入網路輸入成績但尚未致送判別</span></span><br><span class="line"><span class="comment"> *    ToolKit: JDK1.1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">import</span> ncnu.print.*;</span><br><span class="line"><span class="keyword">import</span> ncnu.sql.*;</span><br><span class="line"><span class="keyword">import</span> ncnu.rule.*;</span><br><span class="line"><span class="keyword">import</span> ncnu.gui.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintYLNoticeA4</span> <span class="keyword">extends</span> <span class="title">Print</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> String mynote=<span class="string">"註A 全班成績未到\n註B 個人成績未到(請向老師查明)\n註C 請假\n註D 缺考\n註E 停修"</span>;</span><br><span class="line">    <span class="keyword">static</span> String explain=<span class="string">"說明：學生學期學業成績以各科任課教師送交本處之原始成績冊為憑；本通知單僅為提供參考，若需正式證明請至本處註冊組申請成績單。\n"</span>;</span><br><span class="line">    <span class="keyword">static</span> String explain2=<span class="string">"\n※學生學期學業成績有下列情形者，應予退學：\n一、一般生：學期學業成績累計兩學期不及格科目之學分數，均達        各該學期修習學分總數二分之一者。\n二、僑生、外國生：學期學業成績累計三學期不及格科目之學分數        ，均達各該學期修習學分總數二分之一者。\n三、視、聽、語障礙生：學期學業成績累計三學期不及格科目之學        分數，均達各該學期修習學分總數三分之二者。\n(詳細規定見本校學則第三十二條)"</span>;</span><br><span class="line">    String year;</span><br><span class="line">    String period;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PrintYLNoticeA4</span><span class="params">(Connection con)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(con);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addQueryCondition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        fg.setTitle(<span class="string">"列印學期成績通知單"</span>);</span><br><span class="line">        <span class="keyword">int</span>[] col = &#123;<span class="number">12</span>,<span class="number">10</span>&#125;;</span><br><span class="line">        gui = fg.newTable(col);</span><br><span class="line">        String acaYear = NCNUmisc.getAcaYear();</span><br><span class="line">        String year = acaYear.substring(<span class="number">0</span>,acaYear.length()-<span class="number">1</span>);</span><br><span class="line">        String period = acaYear.substring(acaYear.length()-<span class="number">1</span>, acaYear.length());</span><br><span class="line">        gui.addLabel(<span class="string">"學年"</span>);</span><br><span class="line">        gui.addTextField(<span class="string">"year"</span>,year,<span class="number">3</span>, <span class="number">3</span>,Types.CHAR);</span><br><span class="line">        gui.addLabel(<span class="string">"學期"</span>);</span><br><span class="line">        gui.addTextField(<span class="string">"period"</span>,period,<span class="number">1</span>, <span class="number">1</span>,Types.CHAR);</span><br><span class="line">        gui.addLabel(<span class="string">"系所"</span>);</span><br><span class="line">        gui.addTextField(<span class="string">"deptid"</span>, <span class="string">""</span>,<span class="number">3</span>,<span class="number">3</span>,Types.CHAR);</span><br><span class="line">        gui.addLabel(<span class="string">"班(部)別"</span>);</span><br><span class="line">        gui.addTextField(<span class="string">"class"</span>, <span class="string">""</span>, <span class="number">1</span>, <span class="number">1</span>, Types.CHAR);</span><br><span class="line">        gui.addLabel(<span class="string">"年級"</span>);</span><br><span class="line">        gui.addTextField(<span class="string">"grade"</span>,<span class="string">""</span>,<span class="number">1</span>,<span class="number">1</span>,Types.CHAR);</span><br><span class="line">        gui.addLabel(<span class="string">"開始學號"</span>);</span><br><span class="line">        gui.addTextField(<span class="string">"startid"</span>,<span class="string">""</span>,<span class="number">9</span>, <span class="number">9</span>,Types.CHAR);</span><br><span class="line">        gui.addLabel(<span class="string">"結束學號"</span>);</span><br><span class="line">        gui.addTextField(<span class="string">"endid"</span>,<span class="string">""</span>,<span class="number">9</span>, <span class="number">9</span>,Types.CHAR);</span><br><span class="line">        gui.addLabel(<span class="string">"備註"</span>);</span><br><span class="line">        gui.addTextArea(<span class="string">"note"</span>,mynote, <span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Vector <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String returnString, query;</span><br><span class="line">        Statement stmt;</span><br><span class="line">        ResultSet rs;</span><br><span class="line"></span><br><span class="line">        year = gui.getTextField(<span class="string">"year"</span>).trim();</span><br><span class="line">        period = gui.getTextField(<span class="string">"period"</span>).trim();</span><br><span class="line">        String startid = gui.getTextField(<span class="string">"startid"</span>).trim();</span><br><span class="line">        String endid = gui.getTextField(<span class="string">"endid"</span>).trim();</span><br><span class="line">        String classid = gui.getTextField(<span class="string">"class"</span>).trim();</span><br><span class="line">        String deptid = gui.getTextField(<span class="string">"deptid"</span>).trim();</span><br><span class="line">        String grade = gui.getTextField(<span class="string">"grade"</span>).trim();</span><br><span class="line">        mynote = gui.getTextField(<span class="string">"note"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            stmt  = con.createStatement();</span><br><span class="line">            StringBuffer sb = <span class="keyword">new</span> StringBuffer(<span class="string">"select S.studentid ,D.cname ,S.name, S.pname, S.grade,S.addr2, S.zipcode2,S.addr1, S.zipcode1, S.deptid,S.class from student S,department D where S.deptid=D.deptid and S.status='0'"</span>);</span><br><span class="line">            <span class="keyword">if</span> (!startid.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">                sb.append(<span class="string">" and S.studentid&gt;='"</span>+startid+<span class="string">"'"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!endid.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">                sb.append(<span class="string">" and S.studentid&lt;='"</span>+endid+<span class="string">"'"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!classid.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">                sb.append(<span class="string">" and S.class='"</span>+classid+<span class="string">"'"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!deptid.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">                sb.append(<span class="string">" and S.deptid='"</span>+deptid+<span class="string">"'"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!grade.equals(<span class="string">""</span>)) &#123;</span><br><span class="line">                sb.append(<span class="string">" and S.grade='"</span>+grade+<span class="string">"'"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            sb.append(<span class="string">" order by S.deptid,S.class,S.grade"</span>);</span><br><span class="line">            rs = stmt.executeQuery(sb.toString());</span><br><span class="line">            Vector ids = <span class="keyword">new</span> Vector();</span><br><span class="line">            String[] stuinfo;</span><br><span class="line">            String tmp;</span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                stuinfo= <span class="keyword">new</span> String[<span class="number">11</span>];</span><br><span class="line">                stuinfo[<span class="number">7</span>] = year;</span><br><span class="line">                stuinfo[<span class="number">8</span>] = period;</span><br><span class="line">                stuinfo[<span class="number">6</span>] = rs.getString(<span class="number">1</span>); <span class="comment">// 學號</span></span><br><span class="line">                stuinfo[<span class="number">3</span>] = SQL.fromSQL(rs.getString(<span class="number">2</span>)); <span class="comment">// 系所</span></span><br><span class="line">                stuinfo[<span class="number">5</span>] = SQL.fromSQL (rs.getString(<span class="number">3</span>)); <span class="comment">// student name</span></span><br><span class="line">                tmp = SQL.fromSQL( rs.getString(<span class="number">4</span>));</span><br><span class="line">                tmp = tmp == <span class="keyword">null</span> ? <span class="string">""</span> : tmp.trim ();</span><br><span class="line">                <span class="comment">//若家長欄為空，用學生名</span></span><br><span class="line">                stuinfo[<span class="number">2</span>] = tmp.equals (<span class="string">""</span>) ? stuinfo[<span class="number">5</span>] : tmp; <span class="comment">//收件者姓名</span></span><br><span class="line">                stuinfo[<span class="number">4</span>] = rs.getString(<span class="number">5</span>); <span class="comment">// 年級</span></span><br><span class="line">                String currentAddr = SQL.fromSQL(rs.getString(<span class="number">6</span>)).trim(); <span class="comment">// 通訊地址</span></span><br><span class="line">                String currentZip = SQL.fromSQL(rs.getString(<span class="number">7</span>)).trim(); <span class="comment">// 通訊地址zipcode</span></span><br><span class="line">                String perAddr = SQL.fromSQL(rs.getString(<span class="number">8</span>)).trim(); <span class="comment">// 戶籍地址</span></span><br><span class="line">                String perZip = SQL.fromSQL(rs.getString(<span class="number">9</span>)).trim(); <span class="comment">// 戶籍地址zipcode</span></span><br><span class="line">                <span class="keyword">if</span> (!currentAddr.equals(<span class="string">""</span>))&#123;</span><br><span class="line">                    stuinfo[<span class="number">0</span>] = currentAddr;</span><br><span class="line">                    stuinfo[<span class="number">1</span>] = currentZip;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    stuinfo[<span class="number">0</span>] = perAddr;</span><br><span class="line">                    stuinfo[<span class="number">1</span>] = perZip;</span><br><span class="line">                &#125;</span><br><span class="line">                stuinfo[<span class="number">9</span>] = SQL.fromSQL(rs.getString(<span class="number">10</span>)).trim(); <span class="comment">// deptid</span></span><br><span class="line">                stuinfo[<span class="number">10</span>] = SQL.fromSQL(rs.getString(<span class="number">11</span>)); <span class="comment">// division</span></span><br><span class="line">                ids.addElement (stuinfo);</span><br><span class="line">            &#125;</span><br><span class="line">            rs.close();</span><br><span class="line">            Vector data = <span class="keyword">new</span> Vector();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i &lt; ids.size(); i++) &#123;</span><br><span class="line">                String[] info = (String[])ids.elementAt(i);</span><br><span class="line">                YLNoticeStudent stu = <span class="keyword">new</span> YLNoticeStudent();</span><br><span class="line">                stu.info = info;</span><br><span class="line">                query=<span class="string">"select E.courseid,E.year,E.score,C.cname,C.credit,C.division, opened.senddate,E.netscore"</span> +</span><br><span class="line">                    <span class="string">" from selected E, opened, course C "</span> +</span><br><span class="line">                    <span class="string">" where E.courseid=opened.courseid and E.year=opened.year and E.class=opened.class and E.courseid=C.courseid"</span> +</span><br><span class="line">                    <span class="string">" and E.studentid=\'"</span>+info[<span class="number">6</span>]+<span class="string">"\'"</span>+<span class="string">" and E.year=\'"</span>+year+period+<span class="string">"\' order by C.cname asc"</span>;</span><br><span class="line">                rs = stmt.executeQuery(SQL.toSQL(query));</span><br><span class="line">                <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                    String _courseid = SQL.fromSQL(rs.getString(<span class="number">1</span>)).trim();</span><br><span class="line">                    String _year=SQL.fromSQL(rs.getString(<span class="number">2</span>)).trim();</span><br><span class="line">                    <span class="keyword">double</span> score = rs.getDouble(<span class="number">3</span>);</span><br><span class="line">                    String cname = SQL.fromSQL(rs.getString(<span class="number">4</span>)).trim();</span><br><span class="line">                    <span class="keyword">double</span> credit = rs.getDouble(<span class="number">5</span>);</span><br><span class="line">                    String division = SQL.fromSQL(rs.getString(<span class="number">6</span>));</span><br><span class="line">                    String type = <span class="string">"選修"</span>;</span><br><span class="line">                    String senddate = SQL.toString(rs.getBytes(<span class="number">7</span>));</span><br><span class="line">                    String netscore = SQL.toString(rs.getBytes(<span class="number">8</span>));</span><br><span class="line">                    <span class="comment">// 網路輸入成績,尚未致送教務處</span></span><br><span class="line">                    <span class="keyword">if</span> (senddate.equals(<span class="string">""</span>) &amp;&amp; netscore.equals(<span class="string">"Y"</span>)) &#123;</span><br><span class="line">                        score = -<span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stu.instLearning (type, cname, credit, score, _courseid, _year,division);</span><br><span class="line">                &#125;</span><br><span class="line">                rs.close();</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; stu.learning.size (); j++)&#123;</span><br><span class="line">                    String[] learning = (String[])stu.learning.elementAt (j);</span><br><span class="line">                    <span class="keyword">int</span> entrydate=Integer.parseInt(NCNUmisc.getEnterYear(info[<span class="number">6</span>]).trim());</span><br><span class="line">                    <span class="comment">//查詢必修</span></span><br><span class="line">                    query=<span class="string">"select * from require where courseid=\'"</span>+learning[<span class="number">4</span>]+<span class="string">"\'"</span>+<span class="string">" and deptid=\'"</span>+info[<span class="number">9</span>]+<span class="string">"\'"</span>+<span class="string">" and start&lt;="</span>+entrydate+<span class="string">" and stop&gt;="</span>+entrydate;</span><br><span class="line">                    rs = stmt.executeQuery(query);</span><br><span class="line">                    <span class="keyword">if</span> (rs.next()) learning[<span class="number">0</span>] = <span class="string">"必修"</span>;</span><br><span class="line">                    rs.close();</span><br><span class="line">                    <span class="comment">//判斷此科目是否為雙主修的必修</span></span><br><span class="line">                    query=<span class="string">"select deptid from  whodouble where studentid=\'"</span>+info[<span class="number">6</span>]+<span class="string">"\'"</span>;</span><br><span class="line">                    rs = stmt.executeQuery(query);</span><br><span class="line">                    <span class="keyword">if</span> (rs.next())&#123;</span><br><span class="line">                        String _deptid2= SQL.fromSQL(rs.getString(<span class="number">1</span>)).trim();</span><br><span class="line">                        rs.close();</span><br><span class="line">                        query=<span class="string">"select * from require where courseid=\'"</span>+learning[<span class="number">4</span>]+<span class="string">"\'"</span>+<span class="string">" and deptid=\'"</span>+_deptid2+<span class="string">"\'"</span>+<span class="string">" and start&lt;="</span>+entrydate+<span class="string">" and stop&gt;="</span>+entrydate;</span><br><span class="line">                        rs = stmt.executeQuery(query);</span><br><span class="line">                        <span class="keyword">if</span> (rs.next()) learning[<span class="number">0</span>] = <span class="string">"必修"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    rs.close();</span><br><span class="line">                    <span class="comment">//判斷此科目是否為輔系的必修</span></span><br><span class="line">                    query=<span class="string">"select deptid from  whoassist where studentid=\'"</span>+info[<span class="number">6</span>]+<span class="string">"\'"</span>;</span><br><span class="line">                    rs = stmt.executeQuery(query);</span><br><span class="line">                    <span class="keyword">if</span> (rs.next())&#123;</span><br><span class="line">                        String _deptid3= SQL.fromSQL(rs.getString(<span class="number">1</span>)).trim();</span><br><span class="line">                        rs.close();</span><br><span class="line">                        query=<span class="string">"select * from require where courseid=\'"</span>+learning[<span class="number">4</span>]+<span class="string">"\'"</span>+<span class="string">" and deptid=\'"</span>+_deptid3+<span class="string">"\'"</span>+<span class="string">" and start&lt;="</span>+entrydate+<span class="string">" and stop&gt;="</span>+entrydate;</span><br><span class="line">                        rs = stmt.executeQuery(query);</span><br><span class="line">                        <span class="keyword">if</span> (rs.next()) learning[<span class="number">0</span>] = <span class="string">"必修"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    rs.close();</span><br><span class="line">                    <span class="keyword">if</span> (learning[<span class="number">6</span>].equals(<span class="string">"B"</span>) &amp;&amp; (stu.info[<span class="number">10</span>].equals(<span class="string">"G"</span>)||stu.info[<span class="number">10</span>].equals(<span class="string">"P"</span>))) &#123;</span><br><span class="line">                        learning[<span class="number">0</span>] = <span class="string">"下修"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                query=<span class="string">"select score from conduct where studentid=\'"</span>+info[<span class="number">6</span>]+<span class="string">"\'"</span>+<span class="string">" and year=\'"</span>+year+period+<span class="string">"\'"</span>;</span><br><span class="line">                rs = stmt.executeQuery(query);</span><br><span class="line">                <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">                    stu.bscore = rs.getDouble(<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                rs.close();</span><br><span class="line">                data.addElement(stu);</span><br><span class="line">            &#125;</span><br><span class="line">            stmt.close();</span><br><span class="line">            con.commit();</span><br><span class="line">            <span class="keyword">return</span> data;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            <span class="keyword">new</span> ErrorDialog(fg,SQL.fromSQL (ex.toString()) );</span><br><span class="line">            ex.printStackTrace ();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> PrintCanvas <span class="title">createCanvas</span><span class="params">(Vector data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> PrintYLNoticeCanvas(data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">YLNoticeStudent</span></span>&#123;</span><br><span class="line">        <span class="comment">//   0,  1,    2,   3,    4,    5,        6,   7,     8,     9</span></span><br><span class="line">        <span class="comment">// add,zip,pname,dept,grade,sname,studentid,year,period,deptid</span></span><br><span class="line">        <span class="keyword">public</span> String[] info;</span><br><span class="line">        <span class="keyword">public</span> Vector learning;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">YLNoticeStudent</span><span class="params">()</span></span>&#123;</span><br><span class="line">            learning = <span class="keyword">new</span> Vector();</span><br><span class="line">            tgcredit = <span class="number">0</span>;</span><br><span class="line">            tscore = <span class="number">0</span>;</span><br><span class="line">            course = <span class="number">0</span>;</span><br><span class="line">            knownCredit = <span class="number">0</span>;</span><br><span class="line">            bscore = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> String <span class="title">doubleString</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">            String tmp = Double.toString(x);</span><br><span class="line">            <span class="keyword">if</span> (tmp.equals(<span class="string">".0"</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"0"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (tmp.endsWith(<span class="string">".0"</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> tmp.substring(<span class="number">0</span>,tmp.length()-<span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">instLearning</span><span class="params">(String type, String name</span></span></span><br><span class="line"><span class="function"><span class="params">            , <span class="keyword">double</span> credit, <span class="keyword">double</span> score, String courseid, String year, String division)</span> </span>&#123;</span><br><span class="line">            course ++;</span><br><span class="line">            String[] s = <span class="keyword">new</span> String[<span class="number">7</span>];</span><br><span class="line">            s[<span class="number">0</span>] = type;</span><br><span class="line">            s[<span class="number">1</span>] = name;</span><br><span class="line">            s[<span class="number">2</span>] = doubleString(credit);</span><br><span class="line">            s[<span class="number">4</span>] = courseid;</span><br><span class="line">            s[<span class="number">5</span>] = year;</span><br><span class="line">            s[<span class="number">6</span>] = division;</span><br><span class="line">            tcredit += credit;</span><br><span class="line">            <span class="keyword">if</span> (score == -<span class="number">1</span>)&#123;</span><br><span class="line">                s[<span class="number">3</span>] = <span class="string">"註A"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score == -<span class="number">2</span>) &#123;</span><br><span class="line">                s[<span class="number">3</span>] = <span class="string">"註B"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score == -<span class="number">3</span>) &#123;</span><br><span class="line">                s[<span class="number">3</span>] = <span class="string">"註C"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score == -<span class="number">4</span>) &#123;</span><br><span class="line">                s[<span class="number">3</span>] = <span class="string">"註D"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score == -<span class="number">5</span>) &#123;</span><br><span class="line">                s[<span class="number">3</span>] = <span class="string">"註E"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                s[<span class="number">3</span>] = doubleString (score);</span><br><span class="line">                <span class="keyword">if</span> (division.equals(<span class="string">"B"</span>) &amp;&amp; (info[<span class="number">10</span>].equals(<span class="string">"G"</span>)||info[<span class="number">10</span>].equals(<span class="string">"P"</span>))) &#123;</span><br><span class="line">                    <span class="comment">// 下修</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    knownCredit += credit;</span><br><span class="line">                    tscore += score*credit;</span><br><span class="line">                    <span class="keyword">if</span> (score &gt;= <span class="number">70</span> || (score&gt;=<span class="number">60</span> &amp;&amp; !(info[<span class="number">10</span>].equals(<span class="string">"G"</span>) || info[<span class="number">10</span>].equals(<span class="string">"P"</span>)))) &#123;</span><br><span class="line">                        tgcredit += credit; <span class="comment">//得到學分</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            learning.addElement (s);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getAvgScore</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> knownCredit == <span class="number">0</span> ? <span class="number">0</span> : ((<span class="keyword">int</span>)(tscore/knownCredit*<span class="number">100</span>+<span class="number">0.5</span>))/<span class="number">100.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">double</span> tcredit;   <span class="comment">//修習總學分數</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">double</span> tgcredit;  <span class="comment">//實得學分數</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">double</span> tscore; <span class="comment">//總學分數</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">int</span> course; <span class="comment">//學習課堂數</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">double</span> knownCredit;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">double</span> bscore;<span class="comment">//操行</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">PrintYLNoticeCanvas</span> <span class="keyword">extends</span> <span class="title">PrintCanvas</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getMedia</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"A4"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getOrientation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"portrait"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">dataPerPage</span><span class="params">(<span class="keyword">int</span> pageNum)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">int</span> <span class="title">pagesPerData</span><span class="params">(Object data)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">PrintYLNoticeCanvas</span><span class="params">(Vector data)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(data);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">paint</span><span class="params">(Graphics g)</span> </span>&#123;</span><br><span class="line">            CharArea ca;</span><br><span class="line">            String title=<span class="string">""</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                title = Environment.getTitle()+NCNUmisc.chineseDigit(Integer.parseInt(year))+<span class="string">"學年度第"</span>+NCNUmisc.chineseDigit2(Integer.parseInt(period))+<span class="string">"學期成績通知單"</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span>(Exception ex) &#123;&#125;</span><br><span class="line">            YLNoticeStudent stu = (YLNoticeStudent)data.elementAt(getDataIndex());</span><br><span class="line">            String tmp ;</span><br><span class="line">            <span class="comment">//  寄件地址 郵遞區號 收件者姓名 系所 年級 學生名 學號 學年 學期</span></span><br><span class="line">            <span class="comment">// 成績框</span></span><br><span class="line">            g.drawRect((<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)((<span class="number">1.2</span>)*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.6</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.1</span>*dotPerInch)+<span class="number">1</span>);</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">0.57</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.2</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.57</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.6</span>*dotPerInch));</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">3.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.2</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.4</span>*dotPerInch));</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">3.6</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.2</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.6</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.6</span>*dotPerInch));</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.4</span>*dotPerInch));</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.6</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.6</span>*dotPerInch));</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.8</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.8</span>*dotPerInch));</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9</span>*dotPerInch));</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.2</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.2</span>*dotPerInch));</span><br><span class="line">            g.drawLine((<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.4</span>*dotPerInch));</span><br><span class="line">            g.setFont(<span class="keyword">new</span> Font(<span class="string">"Serif"</span>,Font.PLAIN,(<span class="keyword">int</span>)(<span class="number">0.14</span>*dotPerInch)));</span><br><span class="line">            g.drawString(title,(<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)((<span class="number">0.6</span>)*dotPerInch));</span><br><span class="line">            g.setFont(<span class="keyword">new</span> Font(<span class="string">"Serif"</span>,Font.PLAIN,(<span class="keyword">int</span>)(<span class="number">0.12</span>*dotPerInch)));</span><br><span class="line">            g.drawString(<span class="string">"系所別:"</span>+stu.info[<span class="number">3</span>],(<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.8</span>*dotPerInch));</span><br><span class="line">            g.drawString(<span class="string">"學號:"</span>+stu.info[<span class="number">6</span>],(<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.0</span>*dotPerInch));</span><br><span class="line">            g.drawString(<span class="string">"年級:"</span>+stu.info[<span class="number">4</span>],(<span class="keyword">int</span>)(<span class="number">2.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.8</span>*dotPerInch));</span><br><span class="line">            g.drawString(<span class="string">"姓名:"</span>+stu.info[<span class="number">5</span>],(<span class="keyword">int</span>)(<span class="number">2.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.0</span>*dotPerInch));</span><br><span class="line">            g.drawString(<span class="string">"修別"</span>,(<span class="keyword">int</span>)(<span class="number">0.32</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.35</span>*dotPerInch));</span><br><span class="line">            g.drawString(<span class="string">"課程名稱"</span>,(<span class="keyword">int</span>)(<span class="number">0.9</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.35</span>*dotPerInch));</span><br><span class="line">            g.drawString(<span class="string">"學分"</span>,(<span class="keyword">int</span>)(<span class="number">3.33</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.35</span>*dotPerInch));</span><br><span class="line">            g.drawString(<span class="string">"成績"</span>,(<span class="keyword">int</span>)(<span class="number">3.63</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.35</span>*dotPerInch));</span><br><span class="line">            CharArea.fillH(g,<span class="string">"學業成績總平均"</span>,(<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.55</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.1</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.2</span>*dotPerInch));</span><br><span class="line">            CharArea.fillH(g,<span class="string">"修習總學分數"</span>,(<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.75</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.1</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.2</span>*dotPerInch));</span><br><span class="line">            CharArea.fillH(g,<span class="string">"實得學分數"</span>,(<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">8.95</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.1</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.2</span>*dotPerInch));</span><br><span class="line">            CharArea.fillH(g,<span class="string">"操行成績"</span>,(<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.15</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.1</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.2</span>*dotPerInch));</span><br><span class="line">            ca = <span class="keyword">new</span> CharArea(g,(<span class="keyword">int</span>)(<span class="number">0.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">9.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.2</span>*dotPerInch));</span><br><span class="line">            ca.drawH(<span class="string">"註A 全班成績未到\n註B 個人成績未到(請向老師查明)\n註C 請假\n註D 缺考\n註E 停修"</span>);</span><br><span class="line">            Calendar d = Calendar.getInstance ();</span><br><span class="line">            g.drawString(<span class="string">"填表日期: "</span> + NCNUmisc.chineseDigit(d.get (Calendar.YEAR ) -<span class="number">1911</span>)+<span class="string">" 年 "</span> + NCNUmisc.chineseDigit(d.get (Calendar.MONTH )+<span class="number">1</span>) + <span class="string">" 月 "</span> + NCNUmisc.chineseDigit(d.get (Calendar.DATE )) + <span class="string">" 日"</span> ,(<span class="keyword">int</span>)(<span class="number">0.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">10.5</span>*dotPerInch));</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; stu.learning.size (); i++)&#123;</span><br><span class="line">                String[] data = (String[])stu.learning.elementAt(i);</span><br><span class="line">                g.drawString (data[<span class="number">0</span>], (<span class="keyword">int</span>)((<span class="number">0.32</span>)*dotPerInch), (<span class="keyword">int</span>)((<span class="number">1.5</span> + i*<span class="number">0.14</span>)*dotPerInch));</span><br><span class="line">                g.drawString (data[<span class="number">1</span>], (<span class="keyword">int</span>)((<span class="number">0.6</span>)*dotPerInch), (<span class="keyword">int</span>)((<span class="number">1.5</span> + i*<span class="number">0.14</span>)*dotPerInch));</span><br><span class="line">                g.drawString (data[<span class="number">2</span>], (<span class="keyword">int</span>)((<span class="number">3.4</span>)*dotPerInch), (<span class="keyword">int</span>)((<span class="number">1.5</span> + i*<span class="number">0.14</span>)*dotPerInch));</span><br><span class="line">                g.drawString (data[<span class="number">3</span>], (<span class="keyword">int</span>)((<span class="number">3.65</span>)*dotPerInch), (<span class="keyword">int</span>)((<span class="number">1.5</span> + i*<span class="number">0.14</span>)*dotPerInch));</span><br><span class="line">            &#125;</span><br><span class="line">            g.drawString (<span class="string">""</span> + NCNUmisc.doubleString(stu.getAvgScore()), (<span class="keyword">int</span>)((<span class="number">3.5</span>)*dotPerInch), (<span class="keyword">int</span>)((<span class="number">8.75</span>)*dotPerInch));</span><br><span class="line">            g.drawString (<span class="string">""</span> + NCNUmisc.doubleString(stu.tcredit), (<span class="keyword">int</span>)((<span class="number">3.5</span>)*dotPerInch), (<span class="keyword">int</span>)((<span class="number">8.95</span>)*dotPerInch));</span><br><span class="line">            g.drawString (<span class="string">""</span> + NCNUmisc.doubleString(stu.tgcredit), (<span class="keyword">int</span>)((<span class="number">3.5</span>)*dotPerInch), (<span class="keyword">int</span>)((<span class="number">9.15</span>)*dotPerInch));</span><br><span class="line">            g.drawString (stu.bscore &lt; <span class="number">0</span> ? <span class="string">"未到"</span> : <span class="string">""</span>+NCNUmisc.doubleString(stu.bscore), (<span class="keyword">int</span>)((<span class="number">3.5</span>)*dotPerInch), (<span class="keyword">int</span>)((<span class="number">9.35</span>)*dotPerInch));</span><br><span class="line">            g.drawRect((<span class="keyword">int</span>)(<span class="number">4.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">2.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.7</span>*dotPerInch));</span><br><span class="line">            ca = <span class="keyword">new</span> CharArea(g,(<span class="keyword">int</span>)(<span class="number">4.3</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">6.0</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.5</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">4</span>.*dotPerInch));</span><br><span class="line">            ca.drawH(explain);</span><br><span class="line">            <span class="keyword">if</span> (Environment.getTitle().equals(<span class="string">"國立暨南國際大學"</span>)) &#123;</span><br><span class="line">                ca.drawH(explain2);</span><br><span class="line">            &#125;</span><br><span class="line">            g.drawRect((<span class="keyword">int</span>)(<span class="number">4.3</span>*dotPerInch),(<span class="keyword">int</span>)((<span class="number">0.5</span>)*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.5</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.8</span>*dotPerInch));</span><br><span class="line">            ca = <span class="keyword">new</span> CharArea(g,(<span class="keyword">int</span>)(<span class="number">4.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.8</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">3.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">1.8</span>*dotPerInch));</span><br><span class="line">            g.setFont(<span class="keyword">new</span> Font(<span class="string">"Serif"</span>,Font.PLAIN,(<span class="keyword">int</span>)(<span class="number">0.14</span>*dotPerInch)));</span><br><span class="line">            CharArea.fillV(g,<span class="string">"印刷品"</span>,(<span class="keyword">int</span>)(<span class="number">4.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">2.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.4</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">0.7</span>*dotPerInch));</span><br><span class="line">            g.drawString(Environment.getTitle()+<span class="string">"教務處  寄"</span>,(<span class="keyword">int</span>)(<span class="number">5.0</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">2.55</span>*dotPerInch));</span><br><span class="line">            g.drawString(<span class="string">"校址:"</span>+Environment.addr,(<span class="keyword">int</span>)(<span class="number">5.0</span>*dotPerInch),(<span class="keyword">int</span>)(<span class="number">2.8</span>*dotPerInch));</span><br><span class="line">            ca.drawH(stu.info[<span class="number">1</span>]+<span class="string">" "</span>+stu.info[<span class="number">0</span>]+<span class="string">"\n\n"</span>);</span><br><span class="line">            g.setFont(<span class="keyword">new</span> Font(<span class="string">"Serif"</span>,Font.BOLD,(<span class="keyword">int</span>)(<span class="number">0.20</span>*dotPerInch)));</span><br><span class="line">            ca.drawH(<span class="string">"    "</span>+stu.info[<span class="number">2</span>]+<span class="string">"  君啟"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="執行後的結果"><a href="#執行後的結果" class="headerlink" title="執行後的結果"></a>執行後的結果</h3><p><img src="https://github.com/NCNU-CALab/java.programming.im/raw/master/images/print1.jpg" alt="執行後的結果1"></p>
<p><img src="https://github.com/NCNU-CALab/java.programming.im/raw/master/images/print2.jpg" alt="執行後的結果2"></p>

        <div id="react-support-footer-root"></div>
      </div>
    </div>
  </div>
</div>

    


    

    <!-- js vendors -->
    <script src="//code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/2.1.0/lunr.min.js"></script>

    <!-- js source  -->
    <script src="/script/doc.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    

  </body>
</html>
